GMT进阶之被滥用的-B选项
########################

:date: 2013-08-23 23:15
:author: SeisMan
:category: GMT
:tags: GMT选项, GMT技巧, GMT4
:slug: abused-b-option

.. contents::

GMT的官方文档里称“-B选项大概是GMT里最复杂的选项了，但多数情况下我们只需要使用其最最简单的语法”。这篇博文的目的不是介绍-B选项复杂的语法，而是说说在GMT中使用-B选项的一个误区。

-J、-R、-B作为GMT最常用的三个选项，初学者印象深刻，不知不觉留下了“每个绘图命令都必须给出这三个选项”的印象。在前文《\ `GMT进阶之理解-J和-R的共生关系 <{filename}/GMT/2013-07-15_gmt-option-j-and-r.rst>`_\ 》中已经说到，-J和-R是一对好基友，几乎总是同时出现，并解释了一下二者关系那么好的原因（觉得没解释清，有些东西只可意会啊～）。

-B选项的身份比较尴尬。在命令中可以使用-B来控制图形的边框，而当不使用-B选项时则不会绘制边框。所以，\ **-B选项不是绘图命令所必须的**\ 。

本文到这里基本就该结束了。没有兴趣看示例的可以直接跳到最后的总结。

下面开始给一堆例子来说明这个问题。

第0个例子
=========

这个例子来自于前面的博文《\ `GMT使用-K和-O的技巧 <{filename}/GMT/2013-07-07_how-to-use-gmt-ko.rst>`_\ 》，两个psxy命令中间可以加上需要的各种命令，这里只是为了说明问题，所以就尽量简单。

.. code-block:: bash

   #!/bin/bash

   J=X6i
   R=0/10/0/10
   B=1/1
   PS=TestB0.ps

   psxy -J$J -R$R -T -K > $PS
   psxy -J$J -R$R -T -O >> $PS

这两条命令是用于开关GMT的，没有-B选项，其虽然生成了一些PS代码，但是实际却不显示任何内容。

第1个例子
=========

.. code-block:: bash

   #!/bin/bash

   J=X6i
   R=0/10/0/10
   B=1/1
   PS=TestB1.ps

   psxy -J$J -R$R -B$B -T -K > $PS
   psxy -J$J -R$R -T -O >> $PS

这个例子给第一个psxy命令加上了-B选项，当然也改了一下名字。看一下TestB1.ps会发现，\ **-B的作用是给图形绘制边框**\ ，这是唯一的区别。

第2个例子
=========

.. code-block:: bash

   #!/bin/bash

   J=X6i
   R=0/10/0/10
   B=1/1
   PS=TestB2.ps

   psxy -J$J -R$R -B$B -T -K > $PS
   psxy -J$J -R$R -B$B -T -O >> $PS

这个例子给第二个psxy命令也加上了-B选项。查看TestB2.ps会发现，这张图与TestB1.ps是一样的。这有两种可能：

#. 第二个命令中的-B选项没有发挥作用；
#. 两个命令的-B选项都绘制了边框，由于两个边框相互重合，所以看上去没有区别。

想要验证究竟哪种假设是对的也很简单，用diff命令比较一下两个文件的差异就可以了。通过比较可以发现，此例生成的PS文件相对于上例生成的PS文件，多了很长的一段PS代码，因而可知，两个边框重合了，看上去没有区别。

第3个例子
=========

.. code-block:: bash

   #!/bin/bash

   J=X6i
   R=0/10/0/10
   B=1/1
   PS=TestB3.ps

   psxy -J$J -R$R -B$B -T -K > $PS
   psxy -J$J -R$R -B$B -X1i -T -O >> $PS

这个例子在前一个例子的基础上加了个-X选项，将第二个psxy绘制的边框做了个偏移，可以看到ps文件中出现了两个边框，这个例子进一步证明了两个-B选项都是有绘制边框的。

总结
====

GMT的每个绘图命令都会生成一堆PS代码，这些PS代码表示了整张图的一个图层，众多的绘图命令将多个图层叠加在一起，形成了一个复杂的GMT图形。

- 在不使用-X和-Y的情况下，这些绘图命令共享同一个图形边框，所以只需要\ **第一个**\ 或\ **其中任意一个**\ 命令有-B选项就可以了，其他命令的-B选项是多余的，甚至会有负效果的。
- 若使用了-X和-Y，即一张图中包含多个子图，每个子图有自己的边框，此时每个\ **子图的第一个命令**\ 都需要-B选项，其他命令都不需要。

正确的理解-B选项的用途是很有用的，下面列出一些滥用或活用-B选项的例子：

活用-B选项
----------

#. `绘制波形对比图 <{filename}/GMT/2013-09-15_waveform-comparison-plot.rst>`_
#. `绘制双Y轴 <{filename}/GMT/2014-06-12_double-y-axis-plot.rst>`_

滥用-B选项
----------

#. 重复使用-B选项，导致PS文件占据更多硬盘空间

   上面的四个示例，生成的PS文件的大小分别为::

    TestB0.ps   16146
    TestB1.ps   38562
    TestB2.ps   60978
    TestB3.ps   60993

   当脚本中存在循环，并多次重复使用-B时，浪费的硬盘空间会更多，不过现在硬盘都很大，也不在乎这点空间

#. 重复使用-B选项，导致绘制出的图边框发虚，即看上去精度很低

   `GMT边框发虚的原因及解决办法 <{filename}/GMT/2014-12-09_blurry-frame-in-gmt.rst>`_

修订历史
========

- 2013-08-22：初稿；
- 2013-09-15：增加了“活用-B选项的一个例子”；
- 2014-12-09：增加了“GMT边框发虚”的链接；
- 2015-05-12：新增“绘制双Y轴”的链接；
