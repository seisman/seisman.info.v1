绘制颜色渐变的线条
##################

:date: 2016-01-18
:author: SeisMan
:category: GMT
:tags: GMT5, GMT技巧
:slug: plot-lines-with-gradient-colors

想要绘制一条颜色变化的线段，下面是演示代码：

.. code-block:: bash

   #!/bin/bash
   # GMT v5.2.1

   gmt makecpt -Crainbow -T-2/2/1 > lines.cpt
   gmt psxy -JX15c/4c -R0/6/0/4 -B1 -Clines.cpt -W2p > test.ps << EOF
   > -Z-1.5
   1 2
   2 2
   > -Z-0.5
   2 2
   3 2
   > -Z0.5
   3 2
   4 2
   > -Z1.5
   4 2
   5 2
   EOF

绘图效果如下图：

.. figure:: /images/2016011801.png
   :align: center
   :width: 600 px
   :alt: 用psxy绘制颜色渐变的线段

简单解释一下：

#. ``makecpt`` 命令制作了一个-2到2间隔为1的CPT文件
#. ``psxy`` 命令中使用了 ``-C`` 选项，此时需要输入数据是多段表数据，且每段数据的段头记录中，需要有 ``-Z<val>`` 以指定每段数据的Z值
#. 实际绘图时，对于每段数据，命令会读取该数据数据的段头记录中的 ``-Z<val>`` 中的Z值，然后到CPT文件中查找Z值所对应的颜色，作为该段线段的颜色

实际绘图时，可能遇到的情况是：已知A点和B点的Z值，A点到B点连线上Z值渐变，想要通过线条颜色的渐变来体现Z值的渐变。此时需要一些额外的处理，其中涉及到一些编程，所以下面仅提供思路。

已知A点和B点坐标，利用如下命令将A到B的连线等分成若干份::

    gmt project -C<xA>/<yA> -E<xB>/<yB> -G<dist>

其中 ``-C`` 后接A点坐标， ``-E`` 后接B点坐标， ``-G`` 后接等分后相邻两点间的距离。 ``<dist>`` 越小，A到B线段的颜色变化就越平滑。

最终输出的结果中有三列数据：X坐标、Y坐标和与A点的距离。对于生成的每个点而言，根据A和B两点的Z值、A和B两点之间的距离以及该点与A点之间的距离，通过简单的线性插值，即可得到每一点的Z值。

有了AB之间每一点的坐标和Z值，就可以构建如上例所示的多段数据。对于每段数据而言，其Z值可以取该段数据首尾两点Z值的平均，或者其他取法亦可。
