PKP震相走时曲线
################

:date: 2013-11-01 00:37
:author: SeisMan
:category: 地震学基础
:tags: TauP, 走时, 震相
:slug: pkp-travel-time-curve

.. figure:: /images/2013110101.jpg
   :align: center
   :alt: pkp 
   :width: 700 px

PKP是内核研究中常用的震相。PKP震相一般分为三个，PKPab、PKPbc和PKPdf。其中PKPab为穿过外核中上部的射线，PKPbc为穿过外核底部的射线，PKPdf为穿过内核的射线（即PKIKP）。（一个疑问：为什么没有E呢？）

**成图过程：**

首先利用taup_curve直接生成GMT脚本::

    taup_curve -ph PKP,PKIKP -mod prem -h 100 -gmt

在生成的GMT脚本上做稍许修改，结果如下

.. code-block:: bash

 #!/bin/bash
 gmtset CHAR_ENCODING ISOLatin1+
 gmtset HEADER_FONT_SIZE 30p

 pstext -JX6.0i -P -R110/180/1050.0/1350.0 -B10:"Distance(\232)":/50:"Time(s)":WSen:.'Travel time curve of PKP': -K -Xc > taup_curve.ps <<END
 177.69 1303.39 15 0 0 LM A
 144.83 1163.03 15 0 0 RB B
 152.58 1182.97 15 0 0 LB C
 116.02 1109.21 15 0 0 RB D
 179.00 1195.17 15 0 0 RT F
 END

 psxy -JX -R -m -O >> taup_curve.ps <<END
 > PKP for a source depth of 100.0 kilometers in the prem model
 177.69 1303.39
 173.96 1286.87
 172.49 1280.37
 170.49 1271.52
 168.78 1263.98
 167.41 1257.94
 165.25 1248.42
 163.86 1242.35
 162.67 1237.13
 160.67 1228.44
 159.04 1221.35
 157.65 1215.35
 156.17 1209.01
 154.89 1203.59
 152.79 1194.73
 151.27 1188.38
 150.59 1185.57
 149.96 1183.01
 148.86 1178.56
 147.94 1174.87
 146.89 1170.75
 146.70 1170.00
 145.77 1166.45
 145.28 1164.66
 144.90 1163.30
 144.85 1163.10
 144.83 1163.03
 144.83 1163.06
 145.04 1163.75
 145.25 1164.43
 145.66 1165.68
 146.05 1166.85
 146.26 1167.48
 146.43 1167.98
 146.77 1168.93
 147.11 1169.89
 147.75 1171.62
 148.36 1173.23
 149.04 1174.93
 149.68 1176.51
 149.79 1176.76
 150.56 1178.56
 151.31 1180.27
 152.58 1182.97
 > PKIKP for a source depth of 100.0 kilometers in the prem model
 116.02 1109.21
 121.32 1119.47
 123.31 1123.31
 124.76 1126.09
 125.93 1128.34
 127.78 1131.90
 129.25 1134.71
 130.96 1137.97
 132.35 1140.63
 134.67 1145.00
 136.46 1148.36
 138.04 1151.31
 139.38 1153.76
 140.53 1155.87
 141.55 1157.72
 143.30 1160.83
 144.77 1163.41
 145.97 1165.47
 147.02 1167.25
 147.88 1168.68
 148.68 1169.98
 149.43 1171.20
 150.14 1172.32
 151.34 1174.19
 152.43 1175.83
 153.64 1177.59
 154.10 1178.24
 155.44 1180.09
 156.67 1181.72
 157.49 1182.77
 159.02 1184.62
 160.44 1186.24
 160.60 1186.41
 161.94 1187.83
 163.21 1189.09
 163.54 1189.40
 164.04 1189.86
 165.22 1190.90
 166.38 1191.83
 166.95 1192.27
 167.49 1192.67
 168.33 1193.25
 169.16 1193.78
 170.86 1194.76
 171.72 1195.19
 171.90 1195.28
 173.07 1195.78
 174.20 1196.20
 174.61 1196.33
 175.97 1196.70
 177.30 1196.96
 177.54 1196.99
 178.77 1197.12
 180.00 1197.17
 END
 rm .gmt*

